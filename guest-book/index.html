<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        width: 98vw;
        height: 98vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .guest-book {
        width: 1320px;
        height: 700px;
        background-color: antiquewhite;
      }
    </style>
  </head>
  <body>
    <div class="guest-book"></div>
  </body>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.5/firebase-storage.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCzNxdnZKBGObRbWt5gML4QxE-Q_vF5y_k",
      authDomain: "zusizo-web-site.firebaseapp.com",
      projectId: "zusizo-web-site",
      storageBucket: "zusizo-web-site.appspot.com",
      messagingSenderId: "68338919855",
      appId: "1:68338919855:web:8f35ce792e8fe33547e75a",
      measurementId: "G-TL8B0BGMG5",
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    // 
    const db = firebase.firestore();
    let posts =[] ;
    // 모든 데이터 가져오기
    db.collection('guest-book').get().then((result) => {
      result.forEach((data) => {
        posts.push(data.data());
        console.log(data.data());
      });
      const ul = document.createElement('ul');
      posts.forEach(post => {
        const li = document.createElement('li');

        const userNameElement = document.createElement('p');
        const userName = document.createTextNode(post['username']);
        userNameElement.appendChild(userName);
        li.appendChild(userNameElement);

        const dateElement = document.createElement('p');
        const datetime = new Date(post['date']['seconds']*1000);
        const year = datetime.getFullYear();
        const month = datetime.getMonth();
        const date = datetime.getDate();
        const hours = datetime.getHours();
        const minutes = datetime.getMinutes();

        const dateNode = document.createTextNode(`${year}년 ${month}월 ${date}일 ${hours}:${minutes}`);

        dateElement.appendChild(dateNode);
        li.appendChild(dateElement);

        const descriptionElement = document.createElement('p');
        const description = document.createTextNode(post['description']);
        descriptionElement.appendChild(description);
        li.appendChild(descriptionElement);

        ul.appendChild(li);
      });
      document.body.appendChild(ul);
    });
  </script>
</html>
